import{h as m,p as S,F as T}from"./index-8f09d9d8.js";const h="wss://json-relay-server.onrender.com/ws",z="white",M='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif',A=["#3f5","#f24","#46f","#ef2","#d3f","#f9b","#fff"],F={iceServers:[{urls:["stun:stun.l.google.com:19302"]}]},d={serialize:JSON.stringify,deserialize:JSON.parse},g={serialize:String,deserialize:Number},b={serialize:String,deserialize:Boolean},C=()=>({serialize:e=>e,deserialize:e=>e}),p=C();function E(e){return(s,c,...a)=>{const l=new Set(a),o=new Map,f=e.bindReceive(r=>{var u;if(typeof r!="string")return;const n=r.indexOf(";"),t=n&&r.substring(0,n);if(!t)return;l.has(t)&&e.send(r);const i=o.get(t);if(i!=null&&i.length){const L=(u=c[t])==null?void 0:u.deserialize(r.substring(n+1));i.forEach(w=>w(L))}});return{send(r,n,...t){const i=`${r};${s[r].serialize(n)}`;e.send(i,...t)},on(r,n){var t;o.has(r)||o.set(r,[]),(t=o.get(r))==null||t.push(n)},off(r,n){var i,u;const t=(i=o.get(r))==null?void 0:i.indexOf(n);t!=null&&t!=-1&&((u=o.get(r))==null||u.splice(t,1))},destroy:f||(()=>{})}}}const O={playerState:d,gameState:d,ping:g,err:d},y={setColor:p,setReady:b,setName:p,allowSinglePlayer:b,turn:g,ping:g};function _(e,s){return v(e,s)(O,y,"ping")}function x(e,s){return v(e,s)(y,O)}function v(e,s){return E({send:c=>s.readyState==="open"&&s.send(c),bindReceive(c){return s.addEventListener("message",a=>c(a.data)),()=>{s.close(),e.close()}}})}function D(e,s=5){const[c,a]=m(0),l=c>s,[o,f]=m();S(()=>{f(n=>{n&&(n.onclose=null,n==null||n.close())}),a(0)},[e]),S(()=>{if(!e||o!=null||l)return;const n=new WebSocket(e);let t;return n.onclose=()=>{t=window.setTimeout(()=>{a(i=>i+1),f(void 0)},1e3)},n.onopen=()=>{f(n),a(0)},n.onerror=()=>n.close(),()=>{window.clearTimeout(t)}},[e,c,o]);const r=T(()=>o?{addListener(n){const t=({data:i})=>n(JSON.parse(i));return o.addEventListener("message",t),()=>o.removeEventListener("message",t)},send(n){o.send(JSON.stringify(n))}}:null,[o]);return r==null?{status:l?"failed":"connecting"}:{status:"connected",...r}}const N=Object.entries;function j(e,s,...c){return N(s??{}).filter(a=>!c.includes(typeof a[1])).reduce((a,[l,o])=>((e==null?void 0:e[l])!==o&&(a[l]=o),a),{})}function I(e){throw typeof e=="string"?new Error(e):e}function U(){let e="";for(let s=0;s++<36;e+=s*51&52?(s^15?8^Math.random()*(s^20?16:4):4).toString(16):"-");return e}function J(e,s){return s[e]}export{A,F as D,h as S,E as a,z as b,_ as c,M as d,j as e,U as f,x as g,I as i,d as j,J as m,p as s,D as u};
//# sourceMappingURL=utility-9b4a527b.js.map
