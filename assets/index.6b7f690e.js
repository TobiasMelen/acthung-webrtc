var e=Object.prototype.hasOwnProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,r=Object.assign,o=(r,o)=>{var a={};for(var l in r)e.call(r,l)&&o.indexOf(l)<0&&(a[l]=r[l]);if(null!=r&&t)for(var l of t(r))o.indexOf(l)<0&&n.call(r,l)&&(a[l]=r[l]);return a};import{r as a,v as l,l as s,d as i,a as c}from"./vendor.45817bbd.js";import{s as u,j as d,n as m,a as f,b as y,c as p}from"./snakeGameContext.982ae7a2.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const r=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,a)=>{const l=new URL(e,r);if(self[t].moduleMap[l])return n(self[t].moduleMap[l]);const s=new Blob([`import * as m from '${l}';`,`${t}.moduleMap['${l}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){a(new Error(`Failed to import: ${e}`)),o(i)},onload(){n(self[t].moduleMap[l]),o(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/acthung-webrtc/assets/");function h(e,t){return a.useMemo((()=>{const t=e.filter((e=>null!=e));return t.length<=1?t[0]:Object.assign({},...t)}),null!=t?t:e)}function g(e){const t=a.useMemo((()=>Object.keys(e).map((e=>matchMedia(e)))),[e]),[n,r]=a.useState(new Set(t.filter((e=>e.matches)).map((e=>e.media))));return a.useEffect((()=>t.forEach((e=>e.addListener((e=>r((t=>((e.matches?t.add:t.delete).call(t,e.media),new Set(t))))))))),[e]),a.useMemo((()=>{let t=[];return n.forEach((n=>{const r=e[n];null!=r&&t.push(r)})),t}),[n,e])}const w=e=>({width:"100vw",height:"100%",display:"flex",justifyContent:e?"center":"space-between",alignItems:"center",overflow:"hidden"}),b={"(orientation: landscape)":{flexDirection:"row",margin:"0 auto",overflow:"visible"},"(orientation: portrait)":{flexDirection:"column"}};function v(e){var{centered:t=!0}=e,n=o(e,["centered"]);const l=g(b),s=a.useMemo((()=>w(t)),[t]);return a.createElement("main",r(r({},n),{style:h([s,...l,n.style],[w,l,n.style])}))}function E(e,t){const n=a.useRef();a.useEffect((()=>{const r=n.current;return n.current=t,e(r)}),t)}const S={textAlign:"center",margin:"0 auto"};function k({children:e,style:t,adjustWithChildren:n=!0,startingEm:o=20}){const l=a.useRef(null),[s,i]=a.useState({em:o,validated:!1}),c=a.useCallback((()=>{if(s.validated||null==l.current)return;const e=l.current.clientHeight<=document.body.scrollHeight&&l.current.clientWidth<=document.body.clientWidth;i((t=>r(r({},t),e?{validated:!0}:{em:t.em-1})))}),[s,l.current]);return E((e=>{n&&null!=e&&i({validated:!1,em:o})}),[e]),a.useEffect((()=>{let e;return c(),window.addEventListener("resize",(()=>{window.clearTimeout(e),e=window.setTimeout(c,1e3)})),()=>window.clearTimeout(e)}),[c]),a.createElement(v,null,a.createElement("h1",{style:r(r(r({},t),S),{fontSize:`${s.em}em`,visibility:s.validated?"visible":"hidden"}),ref:l},e))}const C="white",x='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif',R=["#3f5","#f24","#46f","#ef2","#d3f","#f9b","#fff"],j={iceServers:[{urls:["stun:stun.l.google.com:19302"]},{urls:["turn:relay.backups.cz"],credential:"webrtc",username:"webrtc"}]};function O(e){var{direction:t,fill:n,stroke:l=C,strokeWidth:s=5}=e,i=o(e,["direction","fill","stroke","strokeWidth"]);const c=a.useMemo((()=>{const e=s,n=100-s;return(()=>{switch(t){case"up":return[[50,e],[e,n],[n,n]];case"down":return[[e,e],[n,e],[50,n]];case"left":return[[e,50],[n,e],[n,n]];case"right":return[[e,e],[e,n],[n,50]];default:(e=>{throw new Error(`Can't draw triangle in direction "${e}"`)})(t)}})().join(" ")}),[t,s]);return a.createElement("svg",r({viewBox:"0 0 100 100",style:{width:"100%",maxHeight:"100%",display:"block"}},i),a.createElement("polygon",{points:c,strokeWidth:s,style:{fill:n,stroke:l,strokeLinejoin:"round",transition:"fill 150ms ease-out"}}))}function T({setTurn:e,color:t,children:n}){var r,o;const[l,s]=a.useState(0),[i,c]=a.useState(!1),[u,d]=a.useState(!1),m=g({"(orientation: landscape)":["left","right"],"(orientation: portrait)":["up","down"]})[0],f=(t,n)=>{const r=r=>o=>{o.preventDefault(),n(r);const a=l+(r?t:-t);e(a),s(a)};return{onPress:r(!0),onRelease:r(!1)}},y=f(-1,c),p=f(1,d);return a.createElement(v,{centered:!1},a.createElement(M,{color:t,direction:null!=(r=null==m?void 0:m[0])?r:"left",pressed:i,handler:y}),a.createElement("div",null,n),a.createElement(M,{color:t,direction:null!=(o=null==m?void 0:m[1])?o:"right",pressed:u,handler:p}))}const M=({color:e,pressed:t,handler:n,direction:r})=>a.createElement("div",{style:{padding:"0.5em",flexBasis:"33%",alignSelf:"stretch",WebkitUserSelect:"none",touchAction:"none",display:"flex"},onTouchStart:n.onPress,onTouchEnd:n.onRelease},a.createElement(O,{direction:r,stroke:e,fill:t?e:void 0}));var W=a.forwardRef((function(e,t){var n;return a.createElement("input",r(r({autoCapitalize:"characters",type:"text",ref:t},e),{style:h([a.useMemo((()=>{var t;return((e=C)=>({width:"100%",background:"none",fontSize:"2.8em",fontWeight:900,display:"block",border:"none",borderBottom:`5px solid ${e}`,fontFamily:x,borderRadius:0,textAlign:"center",padding:"0.5em 0",textTransform:"uppercase",caretColor:e}))(null==(t=e.style)?void 0:t.color)}),[null==(n=e.style)?void 0:n.color]),e.style])}))}));var L=a.forwardRef((function(e,t){var{color:n=C}=e,l=o(e,["color"]);return a.createElement("button",r(r({ref:t},l),{style:h([a.useMemo((()=>((e,t)=>({border:`5px solid ${e}`,color:e,borderRadius:"1.5em",padding:"0.5em 1.5em",fontWeight:900,fontSize:"1.5em",fontFamily:x,opacity:t?.3:1,background:"none",transition:"color 175ms ease-out, border-color 175ms ease-out"}))(n,l.disabled)),[n,l.disabled]),l.style])}),l.children)}));const I={playerState:d,gameState:d,ping:m,err:d},N={setColor:f,setReady:y,setName:f,turn:m,ping:m};function D(e,t){return P(e,t)(I,N,"ping")}function P(e,t){return u({send:e=>"open"===t.readyState&&t.send(e),triggerReceive(e){t.addEventListener("message",(t=>e(t.data)))},destroy(){t.close(),e.close()}})}function $({lobbyName:e}){const[t,n]=a.useState(),o=a.useMemo((()=>{const t=`playerId/${e}`;let n=sessionStorage[t];return null==n&&(n=l(),sessionStorage[t]=n),n}),[e]);return a.useEffect((()=>{if(null!=t)return;const a=s(...(l={query:{joinLobby:e,from:o}},["https://snake-signals.azurewebsites.net",r({transports:["websocket"]},l)]));var l;a.on("connect",(async()=>{const t=new RTCPeerConnection(j),r=t.createDataChannel("Client data channel",{maxRetransmits:1,ordered:!1});let l;r.onopen=()=>{const e=P(t,r)(N,I);n(e)},t.onicecandidate=t=>{null!=t.candidate&&a.send({to:e,from:o,data:t.candidate.toJSON()})},t.oniceconnectionstatechange=()=>{clearTimeout(l);const e=()=>n((e=>{null==e||e.destroy()}));switch(t.iceConnectionState){case"completed":break;case"disconnected":l=window.setTimeout(e,1e3);break;case"failed":e()}};const s=await t.createOffer();await t.setLocalDescription(s),a.send({data:s,to:e,from:o}),a.on("message",(async({data:e})=>{"answer"===e.type?await t.setRemoteDescription(e):"candidate"in e&&await t.addIceCandidate(e)}))}))}),[t,e]),t}function z(e){const t=function(e,t=100,n=40){const[r,o]=a.useState();return a.useEffect((()=>{if(null==e)return;let r=0,a=0;const l=new Uint8Array(n),s=window.setInterval((()=>{r>a||(e.send("ping",performance.now()),r++)}),t);return e.on("ping",(e=>{l[a]=performance.now()-e,a++,a>=n&&(o(Math.round(l.reduce(((e,t)=>e+t),0)/a)),l.fill(0),a=0,r=0)})),()=>{window.clearInterval(s),o(void 0)}}),[e,t,n]),r}(e),[n,o]=a.useState(),[l,s]=a.useState();a.useEffect((()=>{null!=e&&(e.on("playerState",(e=>o((t=>r(r({},t),e))))),e.on("gameState",(e=>s((t=>r(r({},t),e))))))}),[e]);const i=a.useMemo(((e,t)=>()=>{const n=(n,o)=>a=>{o&&e((e=>e&&r(r({},e),{[o]:a}))),null==t||t.send(n,a)};return{setName:n("setName","name"),setColor:n("setColor"),setReady:n("setReady"),setTurn:n("turn")}})(o,e),[e]);return[n&&r(r(r({},n),i),{latency:t}),l]}function A({lobbyName:e="new"}){const t=$({lobbyName:e}),[n,o]=z(t),l=a.useCallback((()=>{if(null==n)return a.createElement(k,null,"Connecting");switch(n.state){case"joining":return n.ready?a.createElement(k,null,"Waiting"):a.createElement(U,r(r({},n),{colors:null==o?void 0:o.colorAvailability}));case"playing":return a.createElement(T,{setTurn:n.setTurn,color:n.color,latency:n.latency});case"dead":return a.createElement(k,null,"You dead")}}),[n,o]);return a.createElement(v,null,a.createElement(H,{latency:null==n?void 0:n.latency}),l())}function U(e){var{colors:t={}}=e,n=o(e,["colors"]);const[r,l]=a.useState(!1),s=!r&&n.name.startsWith("Player "),i=a.useCallback((e=>{l(!0),n.setName(e.target.value)}),[n.setName]),c=a.useRef(null);return a.createElement("article",{style:{textAlign:"center",maxWidth:"95%",margin:"auto 0"}},a.createElement(W,{ref:c,style:{color:n.color,margin:"1em auto",maxWidth:"75%"},value:s?"":n.name,onChange:i,placeholder:s?n.name:"",maxLength:10,autoCorrect:"off",spellCheck:!1}),a.createElement("section",{style:{display:"flex",flexDirection:"row",width:"100%",flexWrap:"wrap",justifyContent:"center"}},Object.entries(t).map((([e,t])=>{const r=e===n.color;return a.createElement("figure",{key:e,onClick:()=>t&&n.setColor(e),style:{boxSizing:"border-box",width:50,height:50,margin:15,borderRadius:"50%",background:e,transform:r||!t?`scale(${r?1.2:.8})`:void 0,transition:"transform 150ms ease-out, box-shadow 150ms ease-out, opacity 75ms ease-out",opacity:r||t?1:.2,boxShadow:r?"inset 0 0 0 5px rgba(0,0,0,0.1)":"none"}},a.createElement("figcaption",{style:{visibility:"hidden"}},e))}))),a.createElement("section",{style:{marginTop:"1.5em"}},a.createElement(L,{color:n.color,disabled:!n.name,onClick:()=>n.setReady(!0)},"Ready!")))}const H=({latency:e})=>e?a.createElement("span",{style:{position:"absolute",top:0,right:0,WebkitUserSelect:"none"}},e," ms"):null;function B(e){const[t,n]=a.useState({}),[o]=function(e){const t=a.useMemo((()=>s("https://snake-signals.azurewebsites.net",r({transports:["websocket"],autoConnect:!1},e))),[e]),[n,o]=a.useState("connecting");return a.useEffect((()=>(t.connect(),t.on("connect",(()=>o("connected"))),t.on("error",(e=>o("error"))),()=>{t.disconnect(),o("connecting")})),[t]),[t,n]}(a.useMemo((()=>({query:{hostLobby:e}})),[e])),l=a.useCallback((e=>{n((t=>Object.keys(t).reduce(((n,r)=>{var o;if((null==(o=t[r])?void 0:o[0])!==e)n[r]=t[r];else{console.log("discarding connection in state",e.iceConnectionState);try{t[r][1].destroy()}catch(a){console.error("Error cleaning up stale connection",a)}}return n}),{})))}),[n]),i=a.useCallback(((e,t)=>({channel:o})=>{o.onclose=()=>l(e),n((n=>r(r({},n),{[t]:[e,D(e,o)]})))}),[n]);a.useEffect((()=>{o.on("message",(async({from:e,data:t})=>{if("offer"!==t.type||null==e)return;const n=new RTCPeerConnection(j);n.ondatachannel=i(n,e),n.onicecandidate=t=>null!=t.candidate&&o.send({to:e,data:t.candidate.toJSON()}),n.oniceconnectionstatechange=()=>{"failed"===n.iceConnectionState||"disconnected"===n.iceConnectionState&&l(n)},o.on("message",(({from:t,data:r})=>t===e&&"candidate"in r&&n.addIceCandidate(r))),await n.setRemoteDescription(new RTCSessionDescription(t));const r=await n.createAnswer();await n.setLocalDescription(r),o.send({data:r,to:e})}))}),[o,i]);return a.useMemo((()=>Object.entries(t).reduce(((e,[t,n])=>(e[t]=n[1],e)),{})),[t])}const _=Object.entries;function F(e,t,...n){return _(null!=t?t:{}).filter((e=>!n.includes(typeof e[1]))).reduce(((t,[n,r])=>((null==e?void 0:e[n])!==r&&(t[n]=r),t)),{})}const G=(e=[])=>R.reduce(((t,n)=>(t[n]=-1===e.indexOf(n),t)),{});function q(e){const[t,n]=a.useState({}),[l,s]=a.useState({colorAvailability:G()});E((t=>{const[a]=null!=t?t:[{}];let s;n((t=>{let i=1;return Object.keys(e).reduce(((c,u,d)=>{const m=t[u],f=(y=u,e=>n((t=>{var n,{[y]:a}=t,l=o(t,[(n=y,"symbol"==typeof n?n:n+"")]);return r(r({},l),{[y]:e(a)})})));var y;let p=null!=m?m:(()=>{var t;s=null!=s?s:r({},l.colorAvailability);const n=null==(t=Object.entries(s).find((([e,t])=>t)))?void 0:t[0];if(null!=n)return s[n]=!1,{id:u,name:`Player ${d+1}`,color:n,ready:!1,score:0,state:"joining",latency:0,setState:e=>f((t=>r(r({},t),{state:e}))),setScore:e=>f((t=>r(r({},t),{score:e}))),onTurnInput:t=>{var n;return null==(n=e[u])?void 0:n.on("turn",t)}}})();if(null==p)return e[u].send("err",{reason:"lobbyFull",queuespot:i}),i++,c;const h=e[u];return null!=m&&h===a[u]||(h.on("setColor",(e=>{f((t=>r(r({},t),{color:e})))})),h.on("setName",(e=>{f((t=>r(r({},t),{name:e})))})),h.on("setReady",(e=>{f((t=>r(r({},t),{ready:e})))})),p=r(r({},p),{onTurnInput:t=>{var n;return null==(n=e[u])?void 0:n.on("turn",t)}})),c[u]=p,c}),{})}))}),[e]);const i=Object.values(t).map((e=>e.color));a.useEffect((()=>{s((e=>r(r({},e),{colorAvailability:G(i)})))}),[i.join(":")]),E((n=>{const[r,o]=null!=n?n:[];Object.keys(t).forEach((n=>{var a,l;const s=t[n],i=null==o?void 0:o[n];e[n]!=(null==r?void 0:r[n])||null==i?null==(a=e[n])||a.send("playerState",s):s!==i&&(null==(l=e[n])||l.send("playerState",F(i,s,"function")))}))}),[e,t]),E((t=>{const[n,r]=null!=t?t:[],o=r!==l&&F(r,l);Object.keys(e).forEach((t=>{const r=e[t];r!=(null==n?void 0:n[t])?null==r||r.send("gameState",l):o&&(null==r||r.send("gameState",o))}))}),[e,l]);return a.useMemo((()=>Object.values(t)),[t])}let J;const V={},Y={flexGrow:1,height:"100%",width:"100%"};function Q({run:e,input:t,children:n}){const l=a.useRef(null),s=a.useRef();return a.useEffect((()=>{if(null!=l.current)return async function(e,t={}){var{maxVerticalResolution:n=1080}=t,a=o(t,["maxVerticalResolution"]);const l=document.createElement("canvas");e.appendChild(l),l.style.height="100%",l.style.width="100%",e.clientHeight>n?(l.height=n,l.width=n/e.clientHeight*e.clientWidth):(l.height=e.clientHeight,l.width=e.clientWidth);const s=await("OffscreenCanvas"in window?(await function(e,t){if(!t)return e();if(void 0===J){const e=document.createElement("link").relList;J=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in V)return;V[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":J,t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((e,t)=>{r.addEventListener("load",e),r.addEventListener("error",t)})):void 0}))).then((()=>e()))}((()=>__import__("./offscreenGame.d949e227.js")),["/acthung-webrtc/assets/offscreenGame.d949e227.js","/acthung-webrtc/assets/canvasWorkerMessaging.09b47d9d.js","/acthung-webrtc/assets/snakeGameContext.982ae7a2.js"])).default:p)(l,a);return r(r({},s),{destroy(){s.destroy(),e.removeChild(l)}})}(l.current).then((e=>{s.current=e})),()=>{var e;return null==(e=s.current)?void 0:e.destroy()}}),[l.current]),a.useEffect((()=>{const e=s.current;if(null!=e)for(const n of t){const t=e.inputSnakeData(n);n.onTurnInput(t)}}),[s.current,t]),a.useEffect((()=>{const t=s.current;null!=t&&(e?t.run():t.stop())}),[s.current,e]),a.createElement("div",{ref:l,style:Y},n)}function X({children:e,style:t}){return a.createElement(i.QRCode,{value:e,bgColor:"white",fgColor:"black",style:r({backgroundColor:"white",display:"block",position:"relative"},t),preserveAspectRatio:"xMidYMax slice"})}const K={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"start"};function Z({url:e,players:t}){return a.createElement(v,null,a.createElement("div",null),a.createElement("div",{style:{width:"50%",maxHeight:"75%"}},a.createElement(X,{colorScheme:"onWhiteBg",padding:2,style:{maxWidth:600,maxHeight:600,margin:"0 auto 1em auto"}},e),a.createElement("a",{href:e,style:{textAlign:"center",display:"block",fontSize:"0.8em",marginTop:"0.8em",alignSelf:"center"}},e)),a.createElement("div",{style:r(r({},K),{width:0,flexGrow:t.length?.5:0,transition:"flex-grow 500ms ease-in"})},t.map((e=>a.createElement(ee,r({key:e.id},e))))))}const ee=e=>{const[t,n]=a.useState(!1);return a.useEffect((()=>{window.setTimeout((()=>n(!0)),100)}),[]),a.createElement("div",{style:{opacity:t?1:0,margin:"1.2em 0",transition:"transform 150ms ease-in, opacity 150ms ease-in",transform:e.ready?"scale(1.1) translateX(5%)":void 0,animation:"fadeIn 250ms ease-in, fromRight 500ms ease-in",minWidth:"7em"},key:e.id},a.createElement("h2",{style:{color:e.color,fontSize:"3em",transition:"color 150ms",whiteSpace:"nowrap"}},e.name," ",e.ready?a.createElement("small",null,"👍"):"  "))};const te={snakeSpeed:3.3,lineWidth:8,turnRadius:.05,startPositionSpread:.5,startingHoleChancePercantage:-5,holeDuration:10,maxVerticalResolution:1080},ne=a.createContext([te,()=>{}]);function re({children:e}){const t=function(e,t){const n=a.useMemo((()=>(null==localStorage?void 0:localStorage[e])?JSON.parse(localStorage[e]):t),[]),[r,o]=a.useState(n);return a.useEffect((()=>{localStorage&&(localStorage[e]=JSON.stringify(r))}),[r]),[r,o]}("gameSettings",te);return a.createElement(ne.Provider,{value:t},e)}function oe({lobbyName:e}){const t=q(B(e));return a.createElement(re,null,a.createElement(ae,{lobbyName:e,players:t}))}function ae({lobbyName:e,players:t}){const[n,o]=a.useState({type:"waiting"}),l=function(e=0){const[t,n]=a.useState(e),r=a.useRef(),o=a.useRef((e=>{})),l=a.useRef((()=>{})),s=a.useCallback((e=>{o.current=e}),[o]),i=a.useCallback((e=>{l.current=e}),[l]),c=a.useCallback((()=>{clearTimeout(r.current),r.current=void 0}),[]),u=a.useCallback((e=>{c(),null!=e&&n(e),r.current=window.setTimeout(d,1e3)}),[c]),d=a.useCallback((()=>{n((e=>{const t=e-1||0;return o.current(t),t>0?setTimeout(d,1e3):(r.current=void 0,setTimeout(l.current,0)),t}))}),[]);return a.useMemo((()=>({secondsLeft:t,start:u,pause:c,isRunning:null!=r.current,onDone:i,onTick:s})),[t,u,c,r,i,s])}();a.useEffect((()=>{if(t.length||"waiting"===n.type){if("waiting"===n.type&&t.length&&t.every((e=>e.ready))){let e;return e=window.setTimeout((()=>{o({type:"message",message:"Get Ready"}),window.setTimeout((()=>{o({type:"countdown"})}),3e3)}),1e3),()=>{window.clearTimeout(e)}}if("roundOver"===n.type){const e=window.setTimeout((()=>{o({type:"countdown"})}),2500);return()=>window.clearTimeout(e)}"countdown"===n.type&&(!l.isRunning&&l.start(5),l.onDone((()=>o({type:"playing",running:!0,joinedPlayerIds:t.filter((e=>e.ready)).map((e=>(e.setState("playing"),e.id)))}))))}else o({type:"waiting"})}),[t,n]);const s=a.useMemo((()=>"playing"===n.type?t.filter((e=>n.joinedPlayerIds.includes(e.id))).map((e=>({id:e.id,color:e.color,onCollision:()=>(e=>{if("playing"!==n.type)return;e.setState("dead");const a=t.filter((e=>n.joinedPlayerIds.includes(e.id))),l=a.filter((t=>t!==e&&"playing"===t.state));if(l.forEach((e=>e.setScore(e.score+1))),l.length<=1){o((e=>r(r({},e),{running:!1})));const e=a.reduce(((e,t)=>t.score>e.score?t:e)),t=e.score>20?{type:"gameOver",winner:e}:{type:"roundOver",winner:l[0]};window.setTimeout((()=>{o((e=>"playing"===e.type?t:e))}),1e3)}})(e),onTurnInput:e.onTurnInput}))):[]),[n.type,t]),i=`${window.location.protocol}//${window.location.host}${window.location.pathname}#${e}`;switch(n.type){case"waiting":return a.createElement(Z,{players:t,url:i});case"playing":return a.createElement(v,null,a.createElement(Q,{input:s,run:n.running},a.createElement(se,{players:t,url:i})));case"roundOver":return a.createElement(v,null,a.createElement(k,{key:"round-over",startingEm:30},null!=n.winner?a.createElement("span",{style:{color:n.winner.color}},n.winner.name):"Nobody"," ","survives"));case"gameOver":return a.createElement(k,null,a.createElement("span",{style:{color:n.winner.color}},n.winner.name)," ","wins the game");case"message":return a.createElement(k,{startingEm:n.message.length<25?30:void 0},n.message);case"countdown":return a.createElement(a.Fragment,null,a.createElement(se,{players:t,url:i}),a.createElement(le,{count:l.secondsLeft},t.every((e=>0===e.score))?"Game starts":"Next round"," ","in"," "))}}const le=({count:e,children:t})=>a.createElement(k,{key:"countdown",adjustWithChildren:!1,style:{maxWidth:"60%"}},t,a.createElement("span",{style:{display:"inline-block",width:"0.8em"}},e)),se=({players:e,url:t})=>a.createElement("div",{style:{position:"absolute",zIndex:-1,right:0,display:"flex",flexDirection:"column",justifyContent:"center",height:"100%"}},a.createElement("div",{style:{flexGrow:1,display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"flex-end"}},e.map((e=>a.createElement("div",{key:e.id,style:{color:e.color,textAlign:"right",margin:"0 1.5em",paddingBottom:"2em"}},a.createElement("div",{style:{fontSize:"5.2em"}},e.score),a.createElement("div",{style:{fontSize:"1.2em",whiteSpace:"nowrap"}},e.name))))),R.length>e.length&&a.createElement(X,{colorScheme:"onWhiteBg",padding:2,style:{width:150,height:150,margin:"2em"}},t)),ie=()=>location.hash.startsWith("#")?location.hash.substring(1):location.hash;function ce(){const[e,t]=a.useState(ie());a.useEffect((()=>{const e=()=>t(ie());return addEventListener("hashchange",e),()=>removeEventListener("hashchange",e)}),[t]);return a.useCallback((()=>{const t=e;if(t.startsWith("lobby/")){const e=t.substring("lobby/".length);return a.createElement(oe,{lobbyName:e})}return location.hash.length>0?a.createElement(A,{lobbyName:t}):a.createElement(k,{startingEm:10},"New"," ",a.createElement("a",{href:`#lobby/${Math.random().toString(36).substring(8)}`},"Lobby"))}),[e])()}c.render(a.createElement(ce,null),document.getElementById("app-root"));
