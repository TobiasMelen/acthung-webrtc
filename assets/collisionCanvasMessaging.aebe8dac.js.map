{"version":3,"file":"collisionCanvasMessaging.aebe8dac.js","sources":["../../src/messaging/webWorkerMessageChannel.ts","../../src/collisionCanvas/collisionCanvasMessaging.ts"],"sourcesContent":["import setupMessageChannel, {\n  ConverterCollection,\n} from \"./setupMessageChannel\";\n\nexport function createWebWorkerMessageChannel(\n  worker: Worker | DedicatedWorkerGlobalScope\n) {\n  return <\n    SendMessages extends ConverterCollection,\n    ReceiveMessages extends ConverterCollection\n  >(\n    sends: SendMessages,\n    recieves: ReceiveMessages\n  ) =>\n    setupMessageChannel({\n      send: worker.postMessage.bind(worker),\n      bindReceive(receive) {\n        const listener = (ev: any) => receive(ev.data);\n        worker.addEventListener(\"message\", listener);\n        return () => worker.removeEventListener(\"message\", listener)\n      },\n    })(sends, recieves);\n}\n","import { Converter, MessageChannel } from \"../messaging/setupMessageChannel\";\nimport { jsonConverter, stringConverter } from \"../messaging/valueConverters\";\n\nexport const messagesToTracker = {\n  canvasInfo: jsonConverter as Converter<{\n    width: number;\n    height: number;\n    scaleFactor: number;\n    lineWidth: number;\n  }>,\n  positionData: jsonConverter as Converter<\n    { id: string; x: number; y: number; fill?: string }[]\n  >,\n};\nexport const messagesFromTracker = {\n  reportCollision: stringConverter,\n};\n\nexport type TrackerMessageChannel = MessageChannel<\n  typeof messagesToTracker,\n  typeof messagesFromTracker\n>;\n"],"names":["worker","sends","recieves","setupMessageChannel","send","postMessage","bind","[object Object]","receive","listener","ev","data","addEventListener","removeEventListener","messagesToTracker","canvasInfo","jsonConverter","positionData","messagesFromTracker","reportCollision","stringConverter"],"mappings":"sEAKEA,SAEO,CAILC,EACAC,IAEAC,EAAoB,CAClBC,KAAMJ,EAAOK,YAAYC,KAAKN,GAC9BO,YAAYC,SACJC,EAAYC,GAAYF,EAAQE,EAAGC,eAClCC,iBAAiB,UAAWH,GAC5B,IAAMT,EAAOa,oBAAoB,UAAWJ,KALvDN,CAOGF,EAAOC,SClBDY,EAAoB,CAC/BC,WAAYC,EAMZC,aAAcD,GAIHE,EAAsB,CACjCC,gBAAiBC"}