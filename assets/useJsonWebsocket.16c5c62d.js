var e=Object.defineProperty,n=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(n,t,s)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;import{s as a,j as o,n as l,a as c,b as i}from"./valueConverters.50b59f02.js";import{l as u,y as f,d}from"./vendor.afcc7ec4.js";const p="wss://signaling-server.tobbes.site",b="white",m='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif',g=["#3f5","#f24","#46f","#ef2","#d3f","#f9b","#fff"],v={iceServers:[{urls:["stun:stun.l.google.com:19302"]},{urls:["turn:relay.backups.cz"],credential:"webrtc",username:"webrtc"}]},y={playerState:o,gameState:o,ping:l,err:o},w={setColor:c,setReady:i,setName:c,turn:l,ping:l};function S(e,n){return j(e,n)(y,w,"ping")}function O(e,n){return j(e,n)(w,y)}function j(e,n){return a({send:e=>"open"===n.readyState&&n.send(e),bindReceive:t=>(n.addEventListener("message",(e=>t(e.data))),()=>{n.close(),e.close()})})}function E(e,a=5){const[o,l]=u(0),c=o>a,[i,p]=u();f((()=>{p((e=>{e&&(e.onclose=null,null==e||e.close())})),l(0)}),[e]),f((()=>{if(!e||null!=i||c)return;const n=new WebSocket(e);let t;return n.onclose=()=>{t=window.setTimeout((()=>{l((e=>e+1)),p(void 0)}),1e3)},n.onopen=()=>{p(n),l(0)},n.onerror=()=>n.close(),()=>{window.clearTimeout(t)}}),[e,o,i]);const b=d((()=>i?{addListener(e){const n=({data:n})=>e(JSON.parse(n));return i.addEventListener("message",n),()=>i.removeEventListener("message",n)},send(e){i.send(JSON.stringify(e))}}:null),[i]);return null==b?{status:c?"failed":"connecting"}:((e,a)=>{for(var o in a||(a={}))t.call(a,o)&&r(e,o,a[o]);if(n)for(var o of n(a))s.call(a,o)&&r(e,o,a[o]);return e})({status:"connected"},b)}export{g as A,v as D,p as S,b as a,m as b,S as c,O as d,E as u};
//# sourceMappingURL=useJsonWebsocket.16c5c62d.js.map
